---
title: "Lab 06"
author: "Sylvia Baeyens"
date: "8/1/2021"
output:
  github_document:
  html_document:
    html_preview: false
always_allow_html: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r packages, echo= FALSE, include= FALSE}
#including necessary libraries
library(tidyverse)
library(tidytext)
library(dplyr)
library(ggplot2)
library(data.table)
```

Reading in Data 
```{r}
rawData= "mtsamples.csv"
if(!file.exists(rawData))
  download.file("https://raw.githubusercontent.com/USCbiostats/data-science-data/master/00_mtsamples/mtsamples.csv", destfile = rawData)

mtsamples= read.csv(rawData) 
mtsamples= as_tibble(mtsamples)
```

## 1. What specialties do we have?

First, we count the number of specialties
```{r}
Nspecialties = mtsamples %>%
  count(medical_specialty)

Nspecialties %>%
  arrange(desc(n)) %>%
  top_n(15) %>%
  knitr::kable()
```

There are `r nrow(Nspecialties)` specialties.

Next, we look at distribution:
```{r}
#using method 2 from class:

ggplot(Nspecialties, aes(x = n, y = fct_reorder(medical_specialty, n))) +
  geom_col()
```

There is no even distribution among the `r nrow(Nspecialties)` specialties. Surgery has the highest count, while hospice-pallative care has the lowest count.

## 2. Tokenizing the words in the transcription column

Tokenizing words & visualizing top 20:
```{r}
mtsamples %>%
  unnest_tokens(output= word, input= transcription) %>%
  count(word, sort= TRUE) %>%
  top_n(20) %>%
  ggplot(aes(x = n, y = fct_reorder(word, n))) +
  geom_col()
```

The word "patient" is the most common non-filler word. Pronouns are also common words. However, the most common words include "the" and "and." This makes sense, as filler/stop words are very common in written language.

## 3. Removing stopwords

```{r}
mtsamples %>%
  unnest_tokens(output= word, input= transcription) %>%
  count(word, sort= TRUE) %>%
  anti_join(stop_words, by = "word") %>%
  #using method from class (regular expressions) to remove numbers too
  filter(!grepl(pattern= "^[0-9]+$", x= word)) %>%
  top_n(20) %>%
  ggplot(aes(x = n, y = fct_reorder(word, n))) +
  geom_col()
```

Now that we have removed all the stop words and numbers, we see many medical terms among the top 20 most common words. These words include "blood," "skin," "anesthesia" and "artery." The other words among this list make sense given the medical environment.
